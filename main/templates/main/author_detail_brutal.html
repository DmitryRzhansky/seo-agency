{% extends "main/base.html" %}
{% load static %}
{% load seo_tags %}

{% block title %}{{ author.get_full_name }}{% endblock title %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <div class="container">
        <a href="{% url 'main:home' %}">Главная</a><span class="separator">/</span><span class="current">{{ author.get_full_name }}</span>
    </div>
</div>
{% endblock breadcrumbs %}

{% block content %}

<!-- Hero секция -->
<section class="page-hero">
    <div class="container">
        <div class="page-hero-content">
            <h1 class="page-hero-title">{{ author.get_full_name }}</h1>
            {% if author.profile.role %}
            <p class="page-hero-subtitle">{{ author.profile.role }}</p>
            {% elif author.is_staff %}
            <p class="page-hero-subtitle">Автор блога</p>
            {% endif %}
        </div>
    </div>
</section>

<!-- Статистика автора -->
<section class="content-section alt-bg">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Статистика</h2>
        </div>
        <div class="content-grid grid-4">
            <div class="content-card">
                <div style="font-size: 48px; font-weight: 900; color: var(--accent); margin-bottom: 10px; font-family: var(--font-mono);">
                    {{ posts.count }}
                </div>
                <div style="font-size: 14px; font-weight: 700; text-transform: uppercase; color: var(--gray-dark);">
                    Статей опубликовано
                </div>
            </div>
            
            <div class="content-card">
                <div style="font-size: 48px; font-weight: 900; color: var(--accent); margin-bottom: 10px; font-family: var(--font-mono);">
                    {% if posts.exists %}{{ posts.first.published_date|date:"Y" }}{% else %}-{% endif %}
                </div>
                <div style="font-size: 14px; font-weight: 700; text-transform: uppercase; color: var(--gray-dark);">
                    Первая публикация
                </div>
            </div>
            
            <div class="content-card">
                <div style="font-size: 48px; font-weight: 900; color: var(--accent); margin-bottom: 10px; font-family: var(--font-mono);">
                    {% if posts.exists %}{{ posts.last.published_date|date:"d.m.Y" }}{% else %}-{% endif %}
                </div>
                <div style="font-size: 14px; font-weight: 700; text-transform: uppercase; color: var(--gray-dark);">
                    Последняя публикация
                </div>
            </div>
            
            <div class="content-card">
                <div style="font-size: 48px; font-weight: 900; color: var(--accent); margin-bottom: 10px; font-family: var(--font-mono);">
                    {% widthratio total_read_time 1 1 %}
                </div>
                <div style="font-size: 14px; font-weight: 700; text-transform: uppercase; color: var(--gray-dark);">
                    Минут чтения всего
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Категории статей -->
{% if categories_stats %}
<section class="content-section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Категории статей</h2>
        </div>
        <div class="content-grid">
            {% for category, count in categories_stats.items %}
            <div class="content-card">
                <h3 class="content-card-title">
                    <a href="{% url 'blog:category_posts' slug=category.slug %}">{{ category.name }}</a>
                </h3>
                <div style="font-size: 32px; font-weight: 900; color: var(--accent); margin: 20px 0; font-family: var(--font-mono);">
                    {{ count }}
                </div>
                <p class="content-card-text">статей в категории</p>
                <a href="{% url 'blog:category_posts' slug=category.slug %}" class="content-card-link">
                    <span>Смотреть</span>
                    <span class="arrow">→</span>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- Статьи автора -->
{% if posts %}
<section class="content-section alt-bg">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Статьи автора</h2>
        </div>
        <div class="content-grid">
            {% for post in posts %}
            <article class="content-card">
                {% if post.image %}
                <img src="{{ post.image.url }}" class="content-card-image" alt="{{ post.title }}">
                {% else %}
                <div class="content-card-placeholder">
                    <i class="fas fa-newspaper"></i>
                </div>
                {% endif %}
                {% if post.category %}<div class="content-card-meta">{{ post.category.name }}</div>{% endif %}
                <h3 class="content-card-title"><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h3>
                <p class="content-card-text">{{ post.excerpt|default:post.content|striptags|truncatewords:20 }}</p>
                <div class="content-card-footer">
                    <div class="content-card-info">
                        <span>{{ post.published_date|date:"d.m.Y" }}</span>
                        {% if post.read_time %}<span>{{ post.read_time }} мин</span>{% endif %}
                    </div>
                    <a href="{{ post.get_absolute_url }}" class="content-card-link"><span>Читать</span><span class="arrow">→</span></a>
                </div>
            </article>
            {% endfor %}
        </div>
    </div>
</section>
{% else %}
<section class="content-section">
    <div class="container">
        <div class="empty-state">
            <i class="fas fa-newspaper"></i>
            <h3>Пока нет статей</h3>
            <p>Этот автор ещё не опубликовал ни одной статьи.</p>
        </div>
    </div>
</section>
{% endif %}

<!-- CTA -->
<section class="cta-section">
    <div class="container">
        <div class="cta-section-content">
            <h2 class="cta-section-title">Хотите стать автором?</h2>
            <p class="cta-section-text">
                Если у вас есть экспертиза в SEO и digital-маркетинге, мы будем рады видеть вас в нашей команде авторов
            </p>
            <div class="cta-section-buttons">
                <a href="{% url 'main:contacts' %}" class="cta-section-button">
                    <span>Связаться с нами</span>
                </a>
            </div>
        </div>
    </div>
</section>

{% endblock content %}
