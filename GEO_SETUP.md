# Настройка геолокации для продакшена

## Текущая настройка (разработка)

В режиме разработки для локального IP (`127.0.0.1`) возвращается город "Пермь" по умолчанию.

## Настройка для продакшена

### 1. Получение API ключа (рекомендуется)

1. Зарегистрируйтесь на https://ipapi.co/api/
2. Получите бесплатный API ключ
3. Добавьте в `config/settings.py`:

```python
IPAPI_KEY = 'your_api_key_here'
```

### 2. Преимущества API ключа

- **Без ключа**: 1000 запросов/день, только HTTP
- **С ключом**: больше запросов, HTTPS, больше данных

### 3. Альтернативные API

Если нужны другие варианты, можно заменить API в `main/utils.py`:

- **ipinfo.io** - 50,000 запросов/месяц бесплатно
- **ip-api.com** - 1000 запросов/минуту бесплатно
- **ipgeolocation.io** - 30,000 запросов/месяц бесплатно

### 4. Тестирование

Для тестирования в продакшене можно использовать:

```bash
# Проверить определение IP
curl -s "http://ipapi.co/$(curl -s ifconfig.me)/json/"

# Проверить с API ключом
curl -s "https://ipapi.co/$(curl -s ifconfig.me)/json/?key=YOUR_API_KEY"
```

### 5. Мониторинг

Логи ошибок геолокации записываются в Django лог с тегом `main.utils`.
