{% extends 'main/base.html' %}
{% load static %}
{% load seo_tags %}

{% block title %}{{ title }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <div class="container">
        <a href="{% url 'main:home' %}">Главная</a><span class="separator">/</span><span class="current">Карта сайта</span>
    </div>
</div>
{% endblock breadcrumbs %}

{% block content %}

<!-- Hero секция -->
<section class="page-hero">
    <div class="container">
        <div class="page-hero-content">
            <h1 class="page-hero-title">Карта сайта</h1>
            <p class="page-hero-subtitle">
                Полная структура сайта Isakov Agency. Найдите нужную информацию быстро и удобно.
            </p>
        </div>
    </div>
</section>

<!-- Контент -->
<section class="content-section">
    <div class="container">
        
        <!-- Услуги -->
        <div class="section-header">
            <h2 class="section-title">Услуги</h2>
        </div>
        <div class="content-grid">
            {% for category in sitemap_data.services %}
            <div class="content-card">
                <h3 class="content-card-title">
                    <a href="{{ category.get_absolute_url }}">{{ category.title }}</a>
                </h3>
                <ul class="content-list">
                    {% for service in category.services.all %}
                    <li>
                        <a href="{{ service.get_absolute_url }}">{{ service.title }}</a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endfor %}
        </div>

        <!-- Блог -->
        <div class="section-header" style="margin-top: 80px;">
            <h2 class="section-title">Блог</h2>
        </div>
        <div class="content-grid">
            {% for category in sitemap_data.blog_categories %}
            <div class="content-card">
                <div class="content-card-meta">{{ category.post_set.count }} статей</div>
                <h3 class="content-card-title">
                    <a href="{% url 'blog:category_posts' category.slug %}">{{ category.name }}</a>
                </h3>
                <ul class="content-list">
                    {% for post in category.post_set.all|slice:":5" %}
                    <li>
                        <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endfor %}
        </div>

        <!-- Региональные страницы -->
        <div class="section-header" style="margin-top: 80px;">
            <h2 class="section-title">Региональные страницы</h2>
        </div>
        <div class="content-grid grid-4">
            {% for city in sitemap_data.cities %}
            <div class="content-card">
                <h3 class="content-card-title">
                    <a href="{{ city.get_absolute_url }}">{{ city.name }}</a>
                </h3>
                <a href="{{ city.get_absolute_url }}" class="content-card-link">
                    <span>SEO {{ city.get_name_prepositional }}</span>
                    <span class="arrow">→</span>
                </a>
            </div>
            {% endfor %}
        </div>

    </div>
</section>

{% endblock content %}
